<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link href="/style.css?v=1618469111413" rel="stylesheet"><link href="https://rsms.me/inter/inter.css" rel="stylesheet"><link href="/img/Icon.png?v=1618469111413" rel="icon" type="image/png"><meta name="darkreader-lock"><title>Infinite background shader - Learn MonoGame</title><meta name="description" content="Tile an infinite background in no time! This tutorial will teach you how to write a shader that will tile a background infinitely or along any axis."></head><body class="bg-gray-100 dark:bg-gray-900"><div class="md:hidden top-0 bg-gray-100 dark:bg-gray-900 h-16 print:hidden sticky w-full z-10"></div><div class="flex"><div class="flex-none fixed h-screen max-h-screen md:sticky overflow-x-hidden overflow-y-auto pointer-events-none print:hidden top-0 z-20"><div class="flex md:w-64 -ml-px h-full max-w-sm relative w-screen"><input aria-hidden="true" class="menu-btn absolute opacity-0" id="menu_btn" type="checkbox"> <label class="duration-300 ease-out md:hidden bg-gray-600 big-label fixed inset-0 opacity-0 pointer-events-none transition-opacity" for="menu_btn"></label> <label class="inline-block -ml-16 absolute cursor-pointer duration-300 ease-out left-full md:hidden menu-icon pointer-events-auto px-6 py-8 select-none top-0 transition-left z-20" for="menu_btn"><span class="block bg-gray-500 duration-300 ease-out h-2px navicon relative transition-colors w-5"></span></label><div class="flex flex-1 -translate-x-full bg-gray-50 border-gray-200 border-r dark:bg-gray-800 dark:border-gray-700 dark:border-r-2 duration-300 ease-out flex-col invisible max-w-xs md:flex-initial md:transition-none md:translate-x-0 md:visible md:w-64 menu pointer-events-auto transform transition-transform-visibility w-full"><div class="flex items-center flex-shrink-0 h-auto md:h-16 md:py-0 px-4 py-5"><a href="/" class="text-gray-900 dark:hover:text-white dark:text-gray-300 hover:text-gray-900 text-lg">Learn MonoGame</a></div><div class="overflow-y-auto flex-1 h-0 md:flex md:flex-col"><nav class="md:flex-1 md:py-4 px-2 space-y-1"><ul><li class="mt-1"><a href="/how-to/" class="py-2 hover:text-gray-900 dark:focus:text-white dark:hover:text-white dark:text-gray-300 flex focus:text-black font-medium group items-center leading-6 md:leading-5 md:text-sm px-2 text-base text-gray-600"><svg class="h-6 w-6 flex-none md:mr-3 mr-4 dark:group-focus:text-gray-300 dark:group-hover:text-gray-300 group-focus:text-gray-500 group-hover:text-gray-500 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path d="M 9,12 a 3,3 0 1,1 6,0 a 3,3 0 1,1 -6,0" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/></svg> How-to guides</a><ul class="ml-4"><li class="mt-1"><a href="/how-to/get-started/" class="py-2 hover:text-gray-900 dark:focus:text-white dark:hover:text-white dark:text-gray-300 flex focus:text-black font-medium group items-center leading-6 md:leading-5 md:text-sm px-2 text-base text-gray-600"><svg class="h-6 w-6 flex-none md:mr-3 mr-4 dark:group-focus:text-gray-300 dark:group-hover:text-gray-300 group-focus:text-gray-500 group-hover:text-gray-500 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/></svg> Get started</a></li><li class="mt-1"><a href="/how-to/automate-release/" class="py-2 hover:text-gray-900 dark:focus:text-white dark:hover:text-white dark:text-gray-300 flex focus:text-black font-medium group items-center leading-6 md:leading-5 md:text-sm px-2 text-base text-gray-600"><svg class="h-6 w-6 flex-none md:mr-3 mr-4 dark:group-focus:text-gray-300 dark:group-hover:text-gray-300 group-focus:text-gray-500 group-hover:text-gray-500 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path d="M 9,12 a 3,3 0 1,1 6,0 a 3,3 0 1,1 -6,0" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/></svg> Automate release</a></li><li class="mt-1"><a href="/how-to/fullscreen/" class="py-2 hover:text-gray-900 dark:focus:text-white dark:hover:text-white dark:text-gray-300 flex focus:text-black font-medium group items-center leading-6 md:leading-5 md:text-sm px-2 text-base text-gray-600"><svg class="h-6 w-6 flex-none md:mr-3 mr-4 dark:group-focus:text-gray-300 dark:group-hover:text-gray-300 group-focus:text-gray-500 group-hover:text-gray-500 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path d="M 9,12 a 3,3 0 1,1 6,0 a 3,3 0 1,1 -6,0" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/></svg> Fullscreen mode</a></li></ul></li><li class="mt-1"><a href="/tutorial/" class="py-2 hover:text-gray-900 dark:focus:text-white dark:hover:text-white dark:text-gray-300 flex focus:text-black font-medium group items-center leading-6 md:leading-5 md:text-sm px-2 text-base text-gray-600"><svg class="h-6 w-6 flex-none md:mr-3 mr-4 dark:group-focus:text-gray-300 dark:group-hover:text-gray-300 group-focus:text-gray-500 group-hover:text-gray-500 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path d="M 9,12 a 3,3 0 1,1 6,0 a 3,3 0 1,1 -6,0" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/></svg> Tutorials</a><ul class="ml-4"><li class="mt-1"><a href="/tutorial/first-shader/" class="py-2 hover:text-gray-900 dark:focus:text-white dark:hover:text-white dark:text-gray-300 flex focus:text-black font-medium group items-center leading-6 md:leading-5 md:text-sm px-2 text-base text-gray-600"><svg class="h-6 w-6 flex-none md:mr-3 mr-4 dark:group-focus:text-gray-300 dark:group-hover:text-gray-300 group-focus:text-gray-500 group-hover:text-gray-500 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path d="M 9,12 a 3,3 0 1,1 6,0 a 3,3 0 1,1 -6,0" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/></svg> First shader</a></li><li class="mt-1"><span class="py-2 px-2 flex font-medium group items-center leading-6 md:leading-5 md:text-sm text-base dark:text-white text-gray-900 underline"><svg class="h-6 w-6 flex-none md:mr-3 mr-4 dark:text-gray-300 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path d="M 9,12 a 3,3 0 1,1 6,0 a 3,3 0 1,1 -6,0" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/></svg> Infinite background shader</span></li></ul></li></ul></nav></div><div class="flex items-center flex-shrink-0 justify-center p-2"><ul class="flex"><li><a href="https://github.com/MonoGame/MonoGame" class="py-2 px-2 dark:hover:text-gray-300 hover:text-gray-500 inline-block text-gray-400" target="_blank"><span class="sr-only">GitHub</span> <svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a></li><li><a href="https://discord.gg/monogame" class="py-2 px-2 dark:hover:text-gray-300 hover:text-gray-500 inline-block text-gray-400" target="_blank"><svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24"><path d="M20.222 0c1.406 0 2.54 1.137 2.607 2.475V24l-2.677-2.273-1.47-1.338-1.604-1.398.67 2.205H3.71c-1.402 0-2.54-1.065-2.54-2.476V2.48C1.17 1.142 2.31.003 3.715.003h16.5L20.222 0zm-6.118 5.683h-.03l-.202.2c2.073.6 3.076 1.537 3.076 1.537-1.336-.668-2.54-1.002-3.744-1.137-.87-.135-1.74-.064-2.475 0h-.2c-.47 0-1.47.2-2.81.735-.467.203-.735.336-.735.336s1.002-1.002 3.21-1.537l-.135-.135s-1.672-.064-3.477 1.27c0 0-1.805 3.144-1.805 7.02 0 0 1 1.74 3.743 1.806 0 0 .4-.533.805-1.002-1.54-.468-2.14-1.404-2.14-1.404s.134.066.335.2h.06c.03 0 .044.015.06.03v.006c.016.016.03.03.06.03.33.136.66.27.93.4.466.202 1.065.403 1.8.536.93.135 1.996.2 3.21 0 .6-.135 1.2-.267 1.8-.535.39-.2.87-.4 1.397-.737 0 0-.6.936-2.205 1.404.33.466.795 1 .795 1 2.744-.06 3.81-1.8 3.87-1.726 0-3.87-1.815-7.02-1.815-7.02-1.635-1.214-3.165-1.26-3.435-1.26l.056-.02zm.168 4.413c.703 0 1.27.6 1.27 1.335 0 .74-.57 1.34-1.27 1.34-.7 0-1.27-.6-1.27-1.334.002-.74.573-1.338 1.27-1.338zm-4.543 0c.7 0 1.266.6 1.266 1.335 0 .74-.57 1.34-1.27 1.34-.7 0-1.27-.6-1.27-1.334 0-.74.57-1.338 1.27-1.338z"/></svg></a></li><li><a href="https://community.monogame.net/" class="py-2 px-2 dark:hover:text-gray-300 hover:text-gray-500 inline-block text-gray-400" target="_blank"><span class="sr-only">Discourse</span> <svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24"><path d="M12.103 0C18.666 0 24 5.485 24 11.997c0 6.51-5.33 11.99-11.9 11.99L0 24V11.79C0 5.28 5.532 0 12.103 0zm.116 4.563c-2.593-.003-4.996 1.352-6.337 3.57-1.33 2.208-1.387 4.957-.148 7.22L4.4 19.61l4.794-1.074c2.745 1.225 5.965.676 8.136-1.39 2.17-2.054 2.86-5.228 1.737-7.997-1.135-2.778-3.84-4.59-6.84-4.585h-.008z"/></svg></a></li><li><a href="https://gitter.im/MonoGame/MonoGame" class="py-2 px-2 dark:hover:text-gray-300 hover:text-gray-500 inline-block text-gray-400" target="_blank"><span class="sr-only">Gitter</span> <svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24"><path d="M8.501 4.001H10.5V24H8.501V4.001zm6.999 0V24h-2V4.001h2zM3.5 0h2.001v15H3.5V0zm15 4.001h2V15h-2V4.001z"/></svg></a></li><li><a href="https://www.reddit.com/r/monogame/" class="py-2 px-2 dark:hover:text-gray-300 hover:text-gray-500 inline-block text-gray-400" target="_blank"><span class="sr-only">Reddit</span> <svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/></svg></a></li></ul></div></div><div class="md:hidden flex-shrink-0 w-14"></div></div></div><div class="flex flex-1 flex-row-reverse max-w-7xl mx-auto"><div class="bg-gray-100 dark:bg-gray-900 sticky top-0 h-screen hidden lg:flex lg:flex-col overflow-y-hidden pt-20 w-64"><h5 class="text-gray-900 dark:text-gray-100 font-semibold lg:text-xs mb-3 text-sm tracking-wide uppercase">On this page</h5><div class="overflow-y-auto overflow-x-hidden break-words font-medium text-sm"><nav><ol><li><a href="#project-setup" class="py-2 hover:text-gray-900 block dark:hover:text-gray-100 dark:text-gray-400 text-gray-500">Project setup</a><ol><li class="ml-4"><a href="#apos.input" class="py-2 hover:text-gray-900 block dark:hover:text-gray-100 dark:text-gray-400 text-gray-500">Apos.Input</a><ol></ol></li><li class="ml-4"><a href="#assets" class="py-2 hover:text-gray-900 block dark:hover:text-gray-100 dark:text-gray-400 text-gray-500">Assets</a><ol></ol></li><li class="ml-4"><a href="#content-pipeline" class="py-2 hover:text-gray-900 block dark:hover:text-gray-100 dark:text-gray-400 text-gray-500">Content pipeline</a><ol></ol></li><li class="ml-4"><a href="#final-game1.cs" class="py-2 hover:text-gray-900 block dark:hover:text-gray-100 dark:text-gray-400 text-gray-500">Final Game1.cs</a><ol></ol></li></ol></li><li><a href="#explanation" class="py-2 hover:text-gray-900 block dark:hover:text-gray-100 dark:text-gray-400 text-gray-500">Explanation</a><ol></ol></li></ol></nav></div></div><div class="flex flex-1 justify-center"><main class="px-4 break-anywhere dark:prose-dark flex-grow focus:outline-none lg:prose-lg md:px-8 md:py-12 print:px-0 prose py-0 sm:px-6 xl:prose-xl" tabindex="0"><h1 id="infinite-background-shader">Infinite background shader</h1><p>Tile an infinite background in no time! This tutorial will teach you how to write a shader that will tile a background infinitely or along any axis.</p><p>This tutorial builds on top of <a href="../../how-to/get-started/">Get started</a> and <a href="../first-shader/">First shader</a>.</p><p>The first part of this tutorial will walk you through the project setup without explaining much. Once the project is setup and you can run it, you’ll be walked through it line by line to understand how everything works under the hood.</p><h2 id="project-setup">Project setup</h2><p>The completed project can be found <a href="https://github.com/learn-monogame/infinite-background-shader">here</a>.</p><h3 id="apos.input">Apos.Input</h3><p>Since this tutorial focuses on the shader and camera code only, it will rely on my input library. It is called <a href="https://apostolique.github.io/Apos.Input/">Apos.Input</a>. To add it to your project, use the following command:</p><div class="code-select"><div class="code-highlight"><pre class="syntax"><code><span class="line-numbers" aria-hidden="true" style="counter-reset: linenumber 0"><span></span></span>dotnet add package Apos.Input
</code></pre></div></div><h3 id="assets">Assets</h3><p>Add the following image to the <code>Content</code> folder and call it <code>background.png</code>:</p><p><img alt="The background image" src="background.png"></p><p>Next to it, create a text file called <code>infinite.fx</code>. Add the following text to it:</p><div class="code-select"><div class="code-highlight" lang="hlsl"><pre class="syntax"><code><span class="line-numbers" aria-hidden="true" style="counter-reset: linenumber 0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token keyword directive">if</span> <span class="token expression">OPENGL</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token keyword directive">define</span> <span class="token macro-name">VS_SHADERMODEL</span> <span class="token expression">vs_3_0</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token keyword directive">define</span> <span class="token macro-name">PS_SHADERMODEL</span> <span class="token expression">ps_3_0</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token keyword directive">else</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token keyword directive">define</span> <span class="token macro-name">VS_SHADERMODEL</span> <span class="token expression">vs_4_0</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token keyword directive">define</span> <span class="token macro-name">PS_SHADERMODEL</span> <span class="token expression">ps_4_0</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token keyword directive">endif</span></span>

<span class="token keyword keyword-float4x4">float4x4</span> view_projection<span class="token punctuation">;</span>
<span class="token keyword keyword-float4x4">float4x4</span> uv_transform<span class="token punctuation">;</span>
<span class="token keyword keyword-sampler">sampler</span> TextureSampler <span class="token operator">:</span> <span class="token keyword keyword-register">register</span><span class="token punctuation">(</span>s0<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword keyword-struct">struct</span> <span class="token class-name">VertexInput</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-float4">float4</span> Position <span class="token operator">:</span> POSITION0<span class="token punctuation">;</span>
    <span class="token keyword keyword-float4">float4</span> Color <span class="token operator">:</span> COLOR0<span class="token punctuation">;</span>
    <span class="token keyword keyword-float4">float4</span> TexCoord <span class="token operator">:</span> TEXCOORD0<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword keyword-struct">struct</span> <span class="token class-name">PixelInput</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-float4">float4</span> Position <span class="token operator">:</span> SV_Position0<span class="token punctuation">;</span>
    <span class="token keyword keyword-float4">float4</span> Color <span class="token operator">:</span> COLOR0<span class="token punctuation">;</span>
    <span class="token keyword keyword-float4">float4</span> TexCoord <span class="token operator">:</span> TEXCOORD0<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

PixelInput <span class="token function">SpriteVertexShader</span><span class="token punctuation">(</span>VertexInput v<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    PixelInput output<span class="token punctuation">;</span>

    output<span class="token punctuation">.</span>Position <span class="token operator">=</span> <span class="token function">mul</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>Position<span class="token punctuation">,</span> view_projection<span class="token punctuation">)</span><span class="token punctuation">;</span>
    output<span class="token punctuation">.</span>Color <span class="token operator">=</span> v<span class="token punctuation">.</span>Color<span class="token punctuation">;</span>
    output<span class="token punctuation">.</span>TexCoord <span class="token operator">=</span> <span class="token function">mul</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>TexCoord<span class="token punctuation">,</span> uv_transform<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-return">return</span> output<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword keyword-float4">float4</span> <span class="token function">SpritePixelShader</span><span class="token punctuation">(</span>PixelInput p<span class="token punctuation">)</span> <span class="token operator">:</span> COLOR0 <span class="token punctuation">{</span>
    <span class="token keyword keyword-float4">float4</span> diffuse <span class="token operator">=</span> <span class="token function">tex2D</span><span class="token punctuation">(</span>TextureSampler<span class="token punctuation">,</span> p<span class="token punctuation">.</span>TexCoord<span class="token punctuation">.</span>xy<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// if (p.TexCoord.x &lt; 0 || p.TexCoord.x > 1) {</span>
    <span class="token comment">//     discard;</span>
    <span class="token comment">// }</span>

    <span class="token comment">// if (p.TexCoord.y &lt; 0 || p.TexCoord.y > 1) {</span>
    <span class="token comment">//     discard;</span>
    <span class="token comment">// }</span>

    <span class="token keyword keyword-return">return</span> diffuse <span class="token operator">*</span> p<span class="token punctuation">.</span>Color<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword keyword-technique">technique</span> SpriteBatch <span class="token punctuation">{</span>
    <span class="token keyword keyword-pass">pass</span> <span class="token punctuation">{</span>
        <span class="token class-name">VertexShader</span> <span class="token operator">=</span> <span class="token keyword keyword-compile">compile</span> VS_SHADERMODEL <span class="token function">SpriteVertexShader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PixelShader</span> <span class="token operator">=</span> <span class="token keyword keyword-compile">compile</span> PS_SHADERMODEL <span class="token function">SpritePixelShader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div><h3 id="content-pipeline">Content pipeline</h3><p>Open <code>Content.mgcb</code> using the MonoGame Content Builder Editor interface. (Read <a href="../../how-to/get-started/">Get started</a> to learn how to get it.) Add both to the content pipeline editor as an existing item:</p><p><img alt="Use existing item to add them to the MonoGame pipeline." src="add-existing-item.png"></p><p>If you open <code>Content.mgcb</code> as a text file, this is the content you will see:</p><div class="code-select"><div class="code-highlight"><pre class="syntax"><code><span class="line-numbers" aria-hidden="true" style="counter-reset: linenumber 0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span>#----------------------------- Global Properties ----------------------------#

/outputDir:bin/$(Platform)
/intermediateDir:obj/$(Platform)
/platform:DesktopGL
/config:
/profile:HiDef
/compress:True

#-------------------------------- References --------------------------------#


#---------------------------------- Content ---------------------------------#

#begin background.png
/importer:TextureImporter
/processor:TextureProcessor
/processorParam:ColorKeyColor=255,0,255,255
/processorParam:ColorKeyEnabled=True
/processorParam:GenerateMipmaps=False
/processorParam:PremultiplyAlpha=True
/processorParam:ResizeToPowerOfTwo=False
/processorParam:MakeSquare=False
/processorParam:TextureFormat=Color
/build:background.png

#begin infinite.fx
/importer:EffectImporter
/processor:EffectProcessor
/processorParam:DebugMode=Auto
/build:infinite.fx
</code></pre></div></div><h3 id="final-game1.cs">Final Game1.cs</h3><div class="code-select"><div class="code-highlight" lang="csharp"><pre class="syntax"><code><span class="line-numbers" aria-hidden="true" style="counter-reset: linenumber 0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span class="token keyword keyword-using">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword keyword-using">using</span> <span class="token namespace">Apos<span class="token punctuation">.</span>Input</span><span class="token punctuation">;</span>
<span class="token keyword keyword-using">using</span> <span class="token namespace">Microsoft<span class="token punctuation">.</span>Xna<span class="token punctuation">.</span>Framework</span><span class="token punctuation">;</span>
<span class="token keyword keyword-using">using</span> <span class="token namespace">Microsoft<span class="token punctuation">.</span>Xna<span class="token punctuation">.</span>Framework<span class="token punctuation">.</span>Graphics</span><span class="token punctuation">;</span>
<span class="token keyword keyword-using">using</span> <span class="token namespace">Microsoft<span class="token punctuation">.</span>Xna<span class="token punctuation">.</span>Framework<span class="token punctuation">.</span>Input</span><span class="token punctuation">;</span>

<span class="token keyword keyword-namespace">namespace</span> <span class="token namespace">GameProject</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-public">public</span> <span class="token keyword keyword-class">class</span> <span class="token class-name">Game1</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Game</span></span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-public">public</span> <span class="token function">Game1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            _graphics <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name constructor-invocation">GraphicsDeviceManager</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            IsMouseVisible <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            Content<span class="token punctuation">.</span>RootDirectory <span class="token operator">=</span> <span class="token string">"Content"</span><span class="token punctuation">;</span>
            Window<span class="token punctuation">.</span>AllowUserResizing <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword keyword-protected">protected</span> <span class="token keyword keyword-override">override</span> <span class="token class-name return-type"><span class="token keyword keyword-void">void</span></span> <span class="token function">Initialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword keyword-base">base</span><span class="token punctuation">.</span><span class="token function">Initialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword keyword-protected">protected</span> <span class="token keyword keyword-override">override</span> <span class="token class-name return-type"><span class="token keyword keyword-void">void</span></span> <span class="token function">LoadContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            _s <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name constructor-invocation">SpriteBatch</span><span class="token punctuation">(</span>GraphicsDevice<span class="token punctuation">)</span><span class="token punctuation">;</span>

            InputHelper<span class="token punctuation">.</span><span class="token function">Setup</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            _background <span class="token operator">=</span> Content<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Load</span><span class="token class-name generic"><span class="token punctuation">&lt;</span>Texture2D<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token string">"background"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            _infinite <span class="token operator">=</span> Content<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Load</span><span class="token class-name generic"><span class="token punctuation">&lt;</span>Effect<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token string">"infinite"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            _targetScale <span class="token operator">=</span> _maxScale<span class="token punctuation">;</span>
            _scale <span class="token operator">=</span> _targetScale<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword keyword-protected">protected</span> <span class="token keyword keyword-override">override</span> <span class="token class-name return-type"><span class="token keyword keyword-void">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token class-name">GameTime</span> gameTime<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            InputHelper<span class="token punctuation">.</span><span class="token function">UpdateSetup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>_quit<span class="token punctuation">.</span><span class="token function">Pressed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token function">Exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token function">UpdateCameraInput</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            _scale <span class="token operator">=</span> <span class="token function">InterpolateTowardsTarget</span><span class="token punctuation">(</span>_scale<span class="token punctuation">,</span> _targetScale<span class="token punctuation">,</span> _speed<span class="token punctuation">,</span> _snapDistance<span class="token punctuation">)</span><span class="token punctuation">;</span>
            _rotation <span class="token operator">=</span> <span class="token function">InterpolateTowardsTarget</span><span class="token punctuation">(</span>_rotation<span class="token punctuation">,</span> _targetRotation<span class="token punctuation">,</span> _speed<span class="token punctuation">,</span> _snapDistance<span class="token punctuation">)</span><span class="token punctuation">;</span>

            InputHelper<span class="token punctuation">.</span><span class="token function">UpdateCleanup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword keyword-base">base</span><span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span>gameTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword keyword-protected">protected</span> <span class="token keyword keyword-override">override</span> <span class="token class-name return-type"><span class="token keyword keyword-void">void</span></span> <span class="token function">Draw</span><span class="token punctuation">(</span><span class="token class-name">GameTime</span> gameTime<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            GraphicsDevice<span class="token punctuation">.</span><span class="token function">Clear</span><span class="token punctuation">(</span>Color<span class="token punctuation">.</span>Black<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token class-name"><span class="token keyword keyword-int">int</span></span> width <span class="token operator">=</span> GraphicsDevice<span class="token punctuation">.</span>Viewport<span class="token punctuation">.</span>Width<span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword keyword-int">int</span></span> height <span class="token operator">=</span> GraphicsDevice<span class="token punctuation">.</span>Viewport<span class="token punctuation">.</span>Height<span class="token punctuation">;</span>

            <span class="token class-name">Matrix</span> projection <span class="token operator">=</span> Matrix<span class="token punctuation">.</span><span class="token function">CreateOrthographicOffCenter</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Matrix</span> uv_transform <span class="token operator">=</span> <span class="token function">GetUVTransform</span><span class="token punctuation">(</span>_background<span class="token punctuation">,</span> <span class="token keyword keyword-new">new</span> <span class="token class-name constructor-invocation">Vector2</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1f</span><span class="token punctuation">,</span> GraphicsDevice<span class="token punctuation">.</span>Viewport<span class="token punctuation">)</span><span class="token punctuation">;</span>

            _infinite<span class="token punctuation">.</span>Parameters<span class="token punctuation">[</span><span class="token string">"view_projection"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">SetValue</span><span class="token punctuation">(</span>Matrix<span class="token punctuation">.</span>Identity <span class="token operator">*</span> projection<span class="token punctuation">)</span><span class="token punctuation">;</span>
            _infinite<span class="token punctuation">.</span>Parameters<span class="token punctuation">[</span><span class="token string">"uv_transform"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">SetValue</span><span class="token punctuation">(</span>Matrix<span class="token punctuation">.</span><span class="token function">Invert</span><span class="token punctuation">(</span>uv_transform<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            _s<span class="token punctuation">.</span><span class="token function">Begin</span><span class="token punctuation">(</span><span class="token punctuation named-parameter">effect</span><span class="token punctuation">:</span> _infinite<span class="token punctuation">,</span> <span class="token punctuation named-parameter">samplerState</span><span class="token punctuation">:</span> SamplerState<span class="token punctuation">.</span>LinearWrap<span class="token punctuation">)</span><span class="token punctuation">;</span>
            _s<span class="token punctuation">.</span><span class="token function">Draw</span><span class="token punctuation">(</span>_background<span class="token punctuation">,</span> GraphicsDevice<span class="token punctuation">.</span>Viewport<span class="token punctuation">.</span>Bounds<span class="token punctuation">,</span> Color<span class="token punctuation">.</span>White<span class="token punctuation">)</span><span class="token punctuation">;</span>
            _s<span class="token punctuation">.</span><span class="token function">End</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword keyword-base">base</span><span class="token punctuation">.</span><span class="token function">Draw</span><span class="token punctuation">(</span>gameTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword keyword-private">private</span> <span class="token class-name return-type"><span class="token keyword keyword-void">void</span></span> <span class="token function">UpdateCameraInput</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name"><span class="token keyword keyword-int">int</span></span> scrollDelta <span class="token operator">=</span> MouseCondition<span class="token punctuation">.</span>ScrollDelta<span class="token punctuation">;</span>
            <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>scrollDelta <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                _targetScale <span class="token operator">=</span> MathHelper<span class="token punctuation">.</span><span class="token function">Clamp</span><span class="token punctuation">(</span>
                    <span class="token function">LogDistanceToScale</span><span class="token punctuation">(</span><span class="token function">ScaleToLogDistance</span><span class="token punctuation">(</span>_targetScale<span class="token punctuation">)</span> <span class="token operator">-</span> scrollDelta <span class="token operator">*</span> _scrollToLogDistance<span class="token punctuation">)</span>
                    <span class="token punctuation">,</span> _minScale<span class="token punctuation">,</span> _maxScale<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>RotateLeft<span class="token punctuation">.</span><span class="token function">Pressed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                _targetRotation <span class="token operator">+=</span> MathHelper<span class="token punctuation">.</span>Pi <span class="token operator">/</span> <span class="token number">8f</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>RotateRight<span class="token punctuation">.</span><span class="token function">Pressed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                _targetRotation <span class="token operator">-=</span> MathHelper<span class="token punctuation">.</span>Pi <span class="token operator">/</span> <span class="token number">8f</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            _mouseWorld <span class="token operator">=</span> Vector2<span class="token punctuation">.</span><span class="token function">Transform</span><span class="token punctuation">(</span>InputHelper<span class="token punctuation">.</span>NewMouse<span class="token punctuation">.</span>Position<span class="token punctuation">.</span><span class="token function">ToVector2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Matrix<span class="token punctuation">.</span><span class="token function">Invert</span><span class="token punctuation">(</span><span class="token function">GetView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>CameraDrag<span class="token punctuation">.</span><span class="token function">Pressed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                _dragAnchor <span class="token operator">=</span> _mouseWorld<span class="token punctuation">;</span>
                _isDragged <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>_isDragged <span class="token operator">&&</span> CameraDrag<span class="token punctuation">.</span><span class="token function">HeldOnly</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                _xy <span class="token operator">+=</span> _dragAnchor <span class="token operator">-</span> _mouseWorld<span class="token punctuation">;</span>
                _mouseWorld <span class="token operator">=</span> _dragAnchor<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>_isDragged <span class="token operator">&&</span> CameraDrag<span class="token punctuation">.</span><span class="token function">Released</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                _isDragged <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token comment">/// &lt;summary></span>
        <span class="token comment">/// Poor man's tweening function.</span>
        <span class="token comment">/// If the result is stored in the value, it will create a nice interpolation over multiple frames.</span>
        <span class="token comment">/// &lt;/summary></span>
        <span class="token comment">/// &lt;param name="start">The value to start from.&lt;/param></span>
        <span class="token comment">/// &lt;param name="target">The value to reach.&lt;/param></span>
        <span class="token comment">/// &lt;param name="speed">A value between 0f and 1f.&lt;/param></span>
        <span class="token comment">/// &lt;param name="snapNear"></span>
        <span class="token comment">/// When the difference between the target and the result is smaller than this value, the target will be returned.</span>
        <span class="token comment">/// &lt;/param></span>
        <span class="token keyword keyword-private">private</span> <span class="token class-name return-type"><span class="token keyword keyword-float">float</span></span> <span class="token function">InterpolateTowardsTarget</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword keyword-float">float</span></span> start<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword keyword-float">float</span></span> target<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword keyword-float">float</span></span> speed<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword keyword-float">float</span></span> snapNear<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name"><span class="token keyword keyword-float">float</span></span> result <span class="token operator">=</span> MathHelper<span class="token punctuation">.</span><span class="token function">Lerp</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> target<span class="token punctuation">,</span> speed<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>start <span class="token operator">&lt;</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                result <span class="token operator">=</span> MathHelper<span class="token punctuation">.</span><span class="token function">Clamp</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> start<span class="token punctuation">,</span> target<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword keyword-else">else</span> <span class="token punctuation">{</span>
                result <span class="token operator">=</span> MathHelper<span class="token punctuation">.</span><span class="token function">Clamp</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> target<span class="token punctuation">,</span> start<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>MathF<span class="token punctuation">.</span><span class="token function">Abs</span><span class="token punctuation">(</span>target <span class="token operator">-</span> result<span class="token punctuation">)</span> <span class="token operator">&lt;</span> snapNear<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword keyword-return">return</span> target<span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword keyword-else">else</span> <span class="token punctuation">{</span>
                <span class="token keyword keyword-return">return</span> result<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token keyword keyword-private">private</span> <span class="token class-name return-type">Matrix</span> <span class="token function">GetView</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name"><span class="token keyword keyword-int">int</span></span> width <span class="token operator">=</span> GraphicsDevice<span class="token punctuation">.</span>Viewport<span class="token punctuation">.</span>Width<span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword keyword-int">int</span></span> height <span class="token operator">=</span> GraphicsDevice<span class="token punctuation">.</span>Viewport<span class="token punctuation">.</span>Height<span class="token punctuation">;</span>
            <span class="token class-name">Vector2</span> origin <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name constructor-invocation">Vector2</span><span class="token punctuation">(</span>width <span class="token operator">/</span> <span class="token number">2f</span><span class="token punctuation">,</span> height <span class="token operator">/</span> <span class="token number">2f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword keyword-return">return</span>
                Matrix<span class="token punctuation">.</span><span class="token function">CreateTranslation</span><span class="token punctuation">(</span><span class="token operator">-</span>origin<span class="token punctuation">.</span>X<span class="token punctuation">,</span> <span class="token operator">-</span>origin<span class="token punctuation">.</span>Y<span class="token punctuation">,</span> <span class="token number">0f</span><span class="token punctuation">)</span> <span class="token operator">*</span>
                Matrix<span class="token punctuation">.</span><span class="token function">CreateTranslation</span><span class="token punctuation">(</span><span class="token operator">-</span>_xy<span class="token punctuation">.</span>X<span class="token punctuation">,</span> <span class="token operator">-</span>_xy<span class="token punctuation">.</span>Y<span class="token punctuation">,</span> <span class="token number">0f</span><span class="token punctuation">)</span> <span class="token operator">*</span>
                Matrix<span class="token punctuation">.</span><span class="token function">CreateRotationZ</span><span class="token punctuation">(</span>_rotation<span class="token punctuation">)</span> <span class="token operator">*</span>
                Matrix<span class="token punctuation">.</span><span class="token function">CreateScale</span><span class="token punctuation">(</span>_scale<span class="token punctuation">,</span> _scale<span class="token punctuation">,</span> <span class="token number">1f</span><span class="token punctuation">)</span> <span class="token operator">*</span>
                Matrix<span class="token punctuation">.</span><span class="token function">CreateTranslation</span><span class="token punctuation">(</span>origin<span class="token punctuation">.</span>X<span class="token punctuation">,</span> origin<span class="token punctuation">.</span>Y<span class="token punctuation">,</span> <span class="token number">0f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword keyword-private">private</span> <span class="token class-name return-type">Matrix</span> <span class="token function">GetUVTransform</span><span class="token punctuation">(</span><span class="token class-name">Texture2D</span> t<span class="token punctuation">,</span> <span class="token class-name">Vector2</span> offset<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword keyword-float">float</span></span> scale<span class="token punctuation">,</span> <span class="token class-name">Viewport</span> v<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword keyword-return">return</span>
                Matrix<span class="token punctuation">.</span><span class="token function">CreateScale</span><span class="token punctuation">(</span>_background<span class="token punctuation">.</span>Width<span class="token punctuation">,</span> _background<span class="token punctuation">.</span>Height<span class="token punctuation">,</span> <span class="token number">1f</span><span class="token punctuation">)</span> <span class="token operator">*</span>
                Matrix<span class="token punctuation">.</span><span class="token function">CreateScale</span><span class="token punctuation">(</span>scale<span class="token punctuation">,</span> scale<span class="token punctuation">,</span> <span class="token number">1f</span><span class="token punctuation">)</span> <span class="token operator">*</span>
                Matrix<span class="token punctuation">.</span><span class="token function">CreateTranslation</span><span class="token punctuation">(</span>offset<span class="token punctuation">.</span>X<span class="token punctuation">,</span> offset<span class="token punctuation">.</span>Y<span class="token punctuation">,</span> <span class="token number">0f</span><span class="token punctuation">)</span> <span class="token operator">*</span>
                <span class="token function">GetView</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span>
                Matrix<span class="token punctuation">.</span><span class="token function">CreateScale</span><span class="token punctuation">(</span><span class="token number">1f</span> <span class="token operator">/</span> v<span class="token punctuation">.</span>Width<span class="token punctuation">,</span> <span class="token number">1f</span> <span class="token operator">/</span> v<span class="token punctuation">.</span>Height<span class="token punctuation">,</span> <span class="token number">1f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword keyword-private">private</span> <span class="token class-name return-type"><span class="token keyword keyword-float">float</span></span> <span class="token function">ScaleToLogDistance</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword keyword-float">float</span></span> scale<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword keyword-return">return</span> MathF<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token number">1f</span> <span class="token operator">/</span> scale <span class="token operator">+</span> <span class="token number">1f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword keyword-private">private</span> <span class="token class-name return-type"><span class="token keyword keyword-float">float</span></span> <span class="token function">LogDistanceToScale</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword keyword-float">float</span></span> <span class="token keyword keyword-value">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword keyword-return">return</span> <span class="token number">1f</span> <span class="token operator">/</span> <span class="token punctuation">(</span>MathF<span class="token punctuation">.</span><span class="token function">Exp</span><span class="token punctuation">(</span><span class="token keyword keyword-value">value</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">GraphicsDeviceManager</span> _graphics<span class="token punctuation">;</span>
        <span class="token class-name">SpriteBatch</span> _s<span class="token punctuation">;</span>

        <span class="token class-name">Texture2D</span> _background<span class="token punctuation">;</span>
        <span class="token class-name">Effect</span> _infinite<span class="token punctuation">;</span>

        <span class="token class-name">Vector2</span> _xy <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name constructor-invocation">Vector2</span><span class="token punctuation">(</span><span class="token number">0f</span><span class="token punctuation">,</span> <span class="token number">0f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword keyword-float">float</span></span> _scale<span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword keyword-float">float</span></span> _rotation <span class="token operator">=</span> <span class="token number">0f</span><span class="token punctuation">;</span>

        <span class="token class-name"><span class="token keyword keyword-float">float</span></span> _targetScale<span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword keyword-float">float</span></span> _targetRotation <span class="token operator">=</span> <span class="token number">0f</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword keyword-float">float</span></span> _speed <span class="token operator">=</span> <span class="token number">0.1f</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword keyword-float">float</span></span> _snapDistance <span class="token operator">=</span> <span class="token number">0.001f</span><span class="token punctuation">;</span>

        <span class="token class-name">Vector2</span> _mouseWorld <span class="token operator">=</span> Vector2<span class="token punctuation">.</span>Zero<span class="token punctuation">;</span>
        <span class="token class-name">Vector2</span> _dragAnchor <span class="token operator">=</span> Vector2<span class="token punctuation">.</span>Zero<span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword keyword-bool">bool</span></span> _isDragged <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

        <span class="token class-name"><span class="token keyword keyword-float">float</span></span> _scrollToLogDistance <span class="token operator">=</span> <span class="token number">0.001f</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword keyword-float">float</span></span> _minScale <span class="token operator">=</span> <span class="token number">0.1f</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword keyword-float">float</span></span> _maxScale <span class="token operator">=</span> <span class="token number">1f</span><span class="token punctuation">;</span>

        <span class="token class-name">ICondition</span> _quit <span class="token operator">=</span>
            <span class="token keyword keyword-new">new</span> <span class="token class-name constructor-invocation">AnyCondition</span><span class="token punctuation">(</span>
                <span class="token keyword keyword-new">new</span> <span class="token class-name constructor-invocation">KeyboardCondition</span><span class="token punctuation">(</span>Keys<span class="token punctuation">.</span>Escape<span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token keyword keyword-new">new</span> <span class="token class-name constructor-invocation">GamePadCondition</span><span class="token punctuation">(</span>GamePadButton<span class="token punctuation">.</span>Back<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">ICondition</span> RotateLeft <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name constructor-invocation">KeyboardCondition</span><span class="token punctuation">(</span>Keys<span class="token punctuation">.</span>OemComma<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ICondition</span> RotateRight <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name constructor-invocation">KeyboardCondition</span><span class="token punctuation">(</span>Keys<span class="token punctuation">.</span>OemPeriod<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">ICondition</span> CameraDrag <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name constructor-invocation">MouseCondition</span><span class="token punctuation">(</span>MouseButton<span class="token punctuation">.</span>MiddleButton<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div><h2 id="explanation">Explanation</h2><p>In <a href="../first-shader/">First shader</a>, the UV coordinate system got briefly mentioned. It’s a 2D value that ranges between 0 and 1 and covers the whole range of the texture. For a texture that is 200x300 pixels, if you sample it at <code>(0.5, 0.5)</code> in UV coordinates, that gives you the position <code>(100, 150)</code>.</p><hr><p>By default in MonoGame, texture sampling is done using the <code>LinearClamp</code> mode which limits the sampling to the inside of the texture. In order to have an infinite background, we will use a different sampling mode called <code>LinearWrap</code>. This mode wraps around when you sample below 0 or above 1 in UV coordinates.</p><p>You can set LinearWrap in the SpriteBatch’s begin function:</p><div class="code-select"><div class="code-highlight" lang="csharp"><pre class="syntax"><code><span class="line-numbers" aria-hidden="true" style="counter-reset: linenumber 0"><span></span></span>_s<span class="token punctuation">.</span><span class="token function">Begin</span><span class="token punctuation">(</span><span class="token punctuation named-parameter">samplerState</span><span class="token punctuation">:</span> SamplerState<span class="token punctuation">.</span>LinearWrap<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div><hr><p>In the last tutorial, we were drawing the texture in world coordinates and bringing the coordinates back into the homogeneous coordinate system using matrix math. This time, we’ll do something different, we’ll draw a rectangle that covers the whole viewport and transform that into homogenous coordinates.</p><div class="code-select"><div class="code-highlight" lang="csharp"><pre class="syntax"><code><span class="line-numbers" aria-hidden="true" style="counter-reset: linenumber 0"><span></span></span>_s<span class="token punctuation">.</span><span class="token function">Draw</span><span class="token punctuation">(</span>_background<span class="token punctuation">,</span> GraphicsDevice<span class="token punctuation">.</span>Viewport<span class="token punctuation">.</span>Bounds<span class="token punctuation">,</span> Color<span class="token punctuation">.</span>White<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div><p>The matrix to transform the viewport into homogeneous coordinates is:</p><div class="code-select"><div class="code-highlight" lang="csharp"><pre class="syntax"><code><span class="line-numbers" aria-hidden="true" style="counter-reset: linenumber 0"><span></span><span></span><span></span><span></span></span><span class="token class-name"><span class="token keyword keyword-int">int</span></span> width <span class="token operator">=</span> GraphicsDevice<span class="token punctuation">.</span>Viewport<span class="token punctuation">.</span>Width<span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword keyword-int">int</span></span> height <span class="token operator">=</span> GraphicsDevice<span class="token punctuation">.</span>Viewport<span class="token punctuation">.</span>Height<span class="token punctuation">;</span>

<span class="token class-name">Matrix</span> projection <span class="token operator">=</span> Matrix<span class="token punctuation">.</span><span class="token function">CreateOrthographicOffCenter</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div><p>With this in place, if you used the first shader from the previous tutorial and passed the projection matrix to it, you’d see the background texture stretched to cover the whole window.</p><p><img alt="Stretched background" src="stretched-background.png"></p><hr><p>To tile the background infinitely, we have to take the background’s UVs, multiply them by the background’s dimensions so that it ends up in world coordinates at (0, 0), transform them by the view matrix for the camera and then divide that by the viewport rectangle’s dimensions to bring it all into the viewport’s UV coordinates. Here is how to build a matrix that will do all that:</p><div class="code-select"><div class="code-highlight" lang="csharp"><pre class="syntax"><code><span class="line-numbers" aria-hidden="true" style="counter-reset: linenumber 0"><span></span><span></span><span></span><span></span><span></span><span></span></span><span class="token keyword keyword-private">private</span> <span class="token class-name return-type">Matrix</span> <span class="token function">GetUVTransform</span><span class="token punctuation">(</span><span class="token class-name">Texture2D</span> t<span class="token punctuation">,</span> <span class="token class-name">Viewport</span> v<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-return">return</span>
        Matrix<span class="token punctuation">.</span><span class="token function">CreateScale</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>Width<span class="token punctuation">,</span> t<span class="token punctuation">.</span>Height<span class="token punctuation">,</span> <span class="token number">1f</span><span class="token punctuation">)</span> <span class="token operator">*</span>
        <span class="token function">GetView</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span>
        Matrix<span class="token punctuation">.</span><span class="token function">CreateScale</span><span class="token punctuation">(</span><span class="token number">1f</span> <span class="token operator">/</span> v<span class="token punctuation">.</span>Width<span class="token punctuation">,</span> <span class="token number">1f</span> <span class="token operator">/</span> v<span class="token punctuation">.</span>Height<span class="token punctuation">,</span> <span class="token number">1f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div><p>The code to get the view matrix:</p><div class="code-select"><div class="code-highlight" lang="csharp"><pre class="syntax"><code><span class="line-numbers" aria-hidden="true" style="counter-reset: linenumber 0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span class="token keyword keyword-private">private</span> <span class="token class-name return-type">Matrix</span> <span class="token function">GetView</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword keyword-int">int</span></span> width <span class="token operator">=</span> GraphicsDevice<span class="token punctuation">.</span>Viewport<span class="token punctuation">.</span>Width<span class="token punctuation">;</span>
    <span class="token class-name"><span class="token keyword keyword-int">int</span></span> height <span class="token operator">=</span> GraphicsDevice<span class="token punctuation">.</span>Viewport<span class="token punctuation">.</span>Height<span class="token punctuation">;</span>
    <span class="token class-name">Vector2</span> origin <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name constructor-invocation">Vector2</span><span class="token punctuation">(</span>width <span class="token operator">/</span> <span class="token number">2f</span><span class="token punctuation">,</span> height <span class="token operator">/</span> <span class="token number">2f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-return">return</span>
        Matrix<span class="token punctuation">.</span><span class="token function">CreateTranslation</span><span class="token punctuation">(</span><span class="token operator">-</span>origin<span class="token punctuation">.</span>X<span class="token punctuation">,</span> <span class="token operator">-</span>origin<span class="token punctuation">.</span>Y<span class="token punctuation">,</span> <span class="token number">0f</span><span class="token punctuation">)</span> <span class="token operator">*</span>
        Matrix<span class="token punctuation">.</span><span class="token function">CreateTranslation</span><span class="token punctuation">(</span><span class="token operator">-</span>_xy<span class="token punctuation">.</span>X<span class="token punctuation">,</span> <span class="token operator">-</span>_xy<span class="token punctuation">.</span>Y<span class="token punctuation">,</span> <span class="token number">0f</span><span class="token punctuation">)</span> <span class="token operator">*</span>
        Matrix<span class="token punctuation">.</span><span class="token function">CreateRotationZ</span><span class="token punctuation">(</span>_rotation<span class="token punctuation">)</span> <span class="token operator">*</span>
        Matrix<span class="token punctuation">.</span><span class="token function">CreateScale</span><span class="token punctuation">(</span>_scale<span class="token punctuation">,</span> _scale<span class="token punctuation">,</span> <span class="token number">1f</span><span class="token punctuation">)</span> <span class="token operator">*</span>
        Matrix<span class="token punctuation">.</span><span class="token function">CreateTranslation</span><span class="token punctuation">(</span>origin<span class="token punctuation">.</span>X<span class="token punctuation">,</span> origin<span class="token punctuation">.</span>Y<span class="token punctuation">,</span> <span class="token number">0f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div><p>The origin is used so that the scale and rotation operations are done from the center of the viewport instead of the top left.</p><p>In order to have more control on the background texture, we can add an offset and scale input parameter. This will modify it’s position and size in the world independently from the camera.</p><div class="code-select"><div class="code-highlight" lang="csharp"><pre class="syntax"><code><span class="line-numbers" aria-hidden="true" style="counter-reset: linenumber 0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span class="token keyword keyword-private">private</span> <span class="token class-name return-type">Matrix</span> <span class="token function">GetUVTransform</span><span class="token punctuation">(</span><span class="token class-name">Texture2D</span> t<span class="token punctuation">,</span> <span class="token class-name">Vector2</span> offset<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword keyword-float">float</span></span> scale<span class="token punctuation">,</span> <span class="token class-name">Viewport</span> v<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-return">return</span>
        Matrix<span class="token punctuation">.</span><span class="token function">CreateScale</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>Width<span class="token punctuation">,</span> t<span class="token punctuation">.</span>Height<span class="token punctuation">,</span> <span class="token number">1f</span><span class="token punctuation">)</span> <span class="token operator">*</span>
        Matrix<span class="token punctuation">.</span><span class="token function">CreateScale</span><span class="token punctuation">(</span>scale<span class="token punctuation">,</span> scale<span class="token punctuation">,</span> <span class="token number">1f</span><span class="token punctuation">)</span> <span class="token operator">*</span>
        Matrix<span class="token punctuation">.</span><span class="token function">CreateTranslation</span><span class="token punctuation">(</span>offset<span class="token punctuation">.</span>X<span class="token punctuation">,</span> offset<span class="token punctuation">.</span>Y<span class="token punctuation">,</span> <span class="token number">0f</span><span class="token punctuation">)</span> <span class="token operator">*</span>
        <span class="token function">GetView</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span>
        Matrix<span class="token punctuation">.</span><span class="token function">CreateScale</span><span class="token punctuation">(</span><span class="token number">1f</span> <span class="token operator">/</span> v<span class="token punctuation">.</span>Width<span class="token punctuation">,</span> <span class="token number">1f</span> <span class="token operator">/</span> v<span class="token punctuation">.</span>Height<span class="token punctuation">,</span> <span class="token number">1f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div><hr><p>On the shader side, we modify the code from the first shader to use the UV transform matrix:</p><div class="code-select"><div class="code-highlight" lang="hlsl"><pre class="syntax"><code><span class="line-numbers" aria-hidden="true" style="counter-reset: linenumber 0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span>PixelInput <span class="token function">SpriteVertexShader</span><span class="token punctuation">(</span>VertexInput v<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    PixelInput output<span class="token punctuation">;</span>

    output<span class="token punctuation">.</span>Position <span class="token operator">=</span> <span class="token function">mul</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>Position<span class="token punctuation">,</span> view_projection<span class="token punctuation">)</span><span class="token punctuation">;</span>
    output<span class="token punctuation">.</span>Color <span class="token operator">=</span> v<span class="token punctuation">.</span>Color<span class="token punctuation">;</span>
    output<span class="token punctuation">.</span>TexCoord <span class="token operator">=</span> <span class="token function">mul</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>TexCoord<span class="token punctuation">,</span> uv_transform<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-return">return</span> output<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div><p>In the draw function, the only thing left to do is to wire up everything together:</p><div class="code-select"><div class="code-highlight" lang="csharp"><pre class="syntax"><code><span class="line-numbers" aria-hidden="true" style="counter-reset: linenumber 0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span class="token keyword keyword-protected">protected</span> <span class="token keyword keyword-override">override</span> <span class="token class-name return-type"><span class="token keyword keyword-void">void</span></span> <span class="token function">Draw</span><span class="token punctuation">(</span><span class="token class-name">GameTime</span> gameTime<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    GraphicsDevice<span class="token punctuation">.</span><span class="token function">Clear</span><span class="token punctuation">(</span>Color<span class="token punctuation">.</span>Black<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name"><span class="token keyword keyword-int">int</span></span> width <span class="token operator">=</span> GraphicsDevice<span class="token punctuation">.</span>Viewport<span class="token punctuation">.</span>Width<span class="token punctuation">;</span>
    <span class="token class-name"><span class="token keyword keyword-int">int</span></span> height <span class="token operator">=</span> GraphicsDevice<span class="token punctuation">.</span>Viewport<span class="token punctuation">.</span>Height<span class="token punctuation">;</span>

    <span class="token class-name">Matrix</span> projection <span class="token operator">=</span> Matrix<span class="token punctuation">.</span><span class="token function">CreateOrthographicOffCenter</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Matrix</span> uv_transform <span class="token operator">=</span> <span class="token function">GetUVTransform</span><span class="token punctuation">(</span>_background<span class="token punctuation">,</span> <span class="token keyword keyword-new">new</span> <span class="token class-name constructor-invocation">Vector2</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1f</span><span class="token punctuation">,</span> GraphicsDevice<span class="token punctuation">.</span>Viewport<span class="token punctuation">)</span><span class="token punctuation">;</span>

    _infinite<span class="token punctuation">.</span>Parameters<span class="token punctuation">[</span><span class="token string">"view_projection"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">SetValue</span><span class="token punctuation">(</span>Matrix<span class="token punctuation">.</span>Identity <span class="token operator">*</span> projection<span class="token punctuation">)</span><span class="token punctuation">;</span>
    _infinite<span class="token punctuation">.</span>Parameters<span class="token punctuation">[</span><span class="token string">"uv_transform"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">SetValue</span><span class="token punctuation">(</span>Matrix<span class="token punctuation">.</span><span class="token function">Invert</span><span class="token punctuation">(</span>uv_transform<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    _s<span class="token punctuation">.</span><span class="token function">Begin</span><span class="token punctuation">(</span><span class="token punctuation named-parameter">effect</span><span class="token punctuation">:</span> _infinite<span class="token punctuation">,</span> <span class="token punctuation named-parameter">samplerState</span><span class="token punctuation">:</span> SamplerState<span class="token punctuation">.</span>LinearWrap<span class="token punctuation">)</span><span class="token punctuation">;</span>
    _s<span class="token punctuation">.</span><span class="token function">Draw</span><span class="token punctuation">(</span>_background<span class="token punctuation">,</span> GraphicsDevice<span class="token punctuation">.</span>Viewport<span class="token punctuation">.</span>Bounds<span class="token punctuation">,</span> Color<span class="token punctuation">.</span>White<span class="token punctuation">)</span><span class="token punctuation">;</span>
    _s<span class="token punctuation">.</span><span class="token function">End</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-base">base</span><span class="token punctuation">.</span><span class="token function">Draw</span><span class="token punctuation">(</span>gameTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div><p>You will see the final result:</p><p><img alt="Final showcase" src="showcase.png"></p><hr><p>In the final Game1.cs, I have added some extra functions to control the camera. You can click and drag to move the camera around. You can zoom in and out using the mouse scroll wheel. You can also rotate the screen using comma <code>,</code> and dot <code>.</code>.</p><hr><p>As a bonus, you can uncomment the following lines in the shader:</p><div class="code-select"><div class="code-highlight" lang="hlsl"><pre class="syntax"><code><span class="line-numbers" aria-hidden="true" style="counter-reset: linenumber 0"><span></span><span></span><span></span></span><span class="token comment">// if (p.TexCoord.x &lt; 0 || p.TexCoord.x > 1) {</span>
<span class="token comment">//     discard;</span>
<span class="token comment">// }</span>
</code></pre></div></div><div class="code-select"><div class="code-highlight" lang="hlsl"><pre class="syntax"><code><span class="line-numbers" aria-hidden="true" style="counter-reset: linenumber 0"><span></span><span></span><span></span></span><span class="token comment">// if (p.TexCoord.y &lt; 0 || p.TexCoord.y > 1) {</span>
<span class="token comment">//     discard;</span>
<span class="token comment">// }</span>
</code></pre></div></div><p>Those lines will prevent the background from repeating along the X or Y axes. If you uncomment both blocks, the background will not repeat at all.</p><p><img alt="Horizontal Repeat" src="horizontal-repeat.png"><br><img alt="Vertical Repeat" src="vertical-repeat.png"></p><p>You could allow 2 columns to repeat using:</p><div class="code-select"><div class="code-highlight" lang="hlsl"><pre class="syntax"><code><span class="line-numbers" aria-hidden="true" style="counter-reset: linenumber 0"><span></span><span></span><span></span></span><span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>p<span class="token punctuation">.</span>TexCoord<span class="token punctuation">.</span>x <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> p<span class="token punctuation">.</span>TexCoord<span class="token punctuation">.</span>x <span class="token operator">></span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-discard">discard</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div><p>Feel free to experiment with the code and have some fun!</p><sub class="flex justify-end md:pb-0 pb-8 print:hidden"><a href="https://github.com/learn-monogame/learn-monogame.github.io/tree/main/./docs/tutorial/infinite-background-shader/README.md" class="edit-link">Edit this page on GitHub</a></sub></main></div></div></div></body></html>